(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{168:function(e,t,n){},203:function(e,t,n){},228:function(e,t,n){},307:function(e,t,n){},309:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),s=n(80),r=n.n(s),o=n(55),i=n(14),j=n(6),l=n(159),u=n(26),m=(n(168),n(316)),b=n(317),d=n(3),h=n(1),O=n(149),x=window.location.hostname+":4000",g="newChatMessage",f=function(e){var t=Object(c.useState)([]),n=Object(j.a)(t,2),a=n[0],s=n[1],r=Object(c.useRef)();Object(c.useEffect)((function(){return r.current=Object(O.io)(x,{query:{roomId:e}}),r.current.on("connection",(function(e){console.log(e)})),r.current.on("connect_error",(function(e){console.log(e)})),r.current.on("connect_timeout",(function(e){console.log("client connect_timeout: ",e)})),r.current.on(g,(function(e){var t=Object(h.a)(Object(h.a)({},e),{},{ownedByCurrentUser:e.senderId==r.current.id});s((function(e){return[].concat(Object(d.a)(e),[t])}))})),function(){r.current.disconnect()}}),[e]);return{messages:a,sendMessage:function(e,t){r.current.emit(g,{body:e,username:t,senderId:r.current.id,date:new Date})}}},v=n(315),p=(n(203),n(5));function N(e){var t=e.message,n=e.lastMessage,a=t.body,s=t.date,r=t.username,o=t.ownedByCurrentUser,i=Object(c.useRef)();return Object(c.useEffect)((function(){n&&i.current.scrollIntoView()}),[]),Object(p.jsxs)("div",{ref:i,className:"message",children:[Object(p.jsx)("div",{className:"profile",children:r}),Object(p.jsxs)("div",{className:"message-box ".concat(o&&"owner"),children:[Object(p.jsx)("div",{children:Object(p.jsx)("div",{children:a})}),Object(p.jsx)("div",{className:"message-box-timestamp",children:Object(v.a)(new Date(s),"HH:mmaaa")})]})]})}function w(){var e=Object(i.h)(),t=Object(c.useState)(""),n=Object(j.a)(t,2),a=n[0],s=n[1],r=Object(i.i)().id,d=f(r),h=d.messages,O=d.sendMessage;Object(c.useEffect)((function(){s(e.state&&e.state.username?e.state.username:"Anonymous")}),[]);return Object(p.jsx)("div",{className:"chat-page",children:Object(p.jsxs)("div",{className:"chat-window",children:[Object(p.jsxs)("div",{className:"chat-window-header",children:[Object(p.jsx)(o.b,{to:"/home",className:"chat-window-back-link",children:Object(p.jsx)(m.a,{color:"white"})}),Object(p.jsx)("div",{className:"chat-window-title",children:r}),Object(p.jsx)("div",{})]}),Object(p.jsx)("div",{className:"chat-box-container",children:Object(p.jsx)("div",{className:"chat-box",children:Object(p.jsx)("div",{className:"messages-list",children:h.map((function(e,t){var n=t==h.length-1;return Object(p.jsx)(N,{message:e,lastMessage:n},t)}))})})}),Object(p.jsx)("div",{className:"typing-area-container",children:Object(p.jsx)(u.c,{initialValues:{message:""},onSubmit:function(e,t){var n=t.resetForm;console.log(e),O(e.message,a),n()},children:Object(p.jsxs)(u.b,{className:"typing-area",children:[Object(p.jsx)(u.a,{className:"type-box",name:"message",placeholder:"Type something..."}),Object(p.jsx)(l.a,{className:"send-btn",type:"primary",shape:"circle",size:"large",icon:Object(p.jsx)(b.a,{})})]})})})]})})}n(228);var y=n(92),I=n(15),S=n(314),k=["name","label","value","formikBag"];function C(e){var t=e.name,n=e.label,c=e.value,a=e.formikBag,s=Object(I.a)(e,k),r=a.values,o=a.handleChange,i=a.errors;return Object(p.jsxs)("div",{className:"input",children:[n?Object(p.jsx)("label",{children:n}):null,Object(p.jsx)(S.a,Object(h.a)({name:t,value:c||r[t],onChange:o},s)),i[t]&&Object(p.jsx)("div",{className:"err-msg",children:i[t]})]})}var D=y.a().shape({roomID:y.b().required("Room ID is required"),username:y.b()});function B(){var e=Object(i.g)();return Object(p.jsx)("div",{className:"home-page",children:Object(p.jsxs)("div",{children:[Object(p.jsx)("h1",{className:"home-page-title",children:"Join a Chatroom"}),Object(p.jsx)(u.c,{initialValues:{username:"",roomID:""},validationSchema:D,onSubmit:function(t){return function(t){var n=t.username;t.roomID,e.push("/chat/".concat(t.roomID),{username:n})}(t)},children:function(e){return Object(p.jsxs)(u.b,{className:"form",children:[Object(p.jsx)(C,{size:"large",name:"roomID",placeholder:"Room Name",formikBag:e}),Object(p.jsx)(C,{size:"large",name:"username",placeholder:"Username",formikBag:e}),Object(p.jsx)("button",{className:"join-room-btn",type:"submit",children:"Join Room"})]})}})]})})}function M(){var e=Object(i.g)();return Object(p.jsx)("div",{children:Object(p.jsx)(u.c,{initialValues:{username:""},onSubmit:function(t){return function(t){console.log(t);var n=t.username;localStorage.setItem("username",n),e.push("/chat",t)}(t)},children:Object(p.jsxs)(u.b,{children:[Object(p.jsx)(u.a,{name:"username",placeholder:"wackyhorse99"}),Object(p.jsx)("button",{type:"submit",children:"Submit"})]})})})}var F=function(){return Object(p.jsx)(o.a,{children:Object(p.jsxs)(i.d,{children:[Object(p.jsx)(i.a,{exact:!0,path:"/",to:"/home"}),Object(p.jsx)(i.b,{path:"/login",component:M}),Object(p.jsx)(i.b,{path:"/home",component:B}),Object(p.jsx)(i.b,{path:"/chat/:id",component:w})]})})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,318)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),s(e),r(e)}))};n(307),n(308);r.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(F,{})}),document.getElementById("root")),R()}},[[309,1,2]]]);
//# sourceMappingURL=main.64003bc3.chunk.js.map